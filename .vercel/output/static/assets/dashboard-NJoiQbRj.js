import{a as m,u as x,j as e,s as i}from"./main-B5FlV0ud.js";import{A as h,D as g}from"./AdminGuard-CcPwdLTL.js";import"./x-DfPbw0Sj.js";import"./button-BmSOyNex.js";import"./search-BWiiaxVB.js";function v(){const{profile:n,session:d,signOut:c}=m(),l=n?.name??d?.user.email??"Admin",u=d?.user.email??"",s=x({queryKey:["admin","metrics"],queryFn:async()=>{const r=new Date;r.setHours(0,0,0,0);const[a,t,o]=await Promise.all([i.from("orders").select("id",{count:"exact",head:!0}).gte("created_at",r.toISOString()),i.from("books").select("id",{count:"exact",head:!0}).eq("is_active",!0),i.from("authors").select("id",{count:"exact",head:!0})]);if(a.error)throw a.error;if(t.error)throw t.error;if(o.error)throw o.error;return{ordersToday:a.count??0,activeBooks:t.count??0,authorsCount:o.count??0}},staleTime:3e4});return e.jsx(h,{children:e.jsx(g,{userRole:n?.role??"admin",userName:l,userEmail:u,onSignOut:c,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase text-gray-500",children:"Overview"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Catalogus dashboard"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Quick snapshot of orders, books, and authors."})]}),s.isFetching&&e.jsx("span",{className:"text-xs text-gray-500",children:"Updating…"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{label:"Orders today",value:s.data?.ordersToday?.toString()??(s.isLoading?"…":"0")},{label:"Active books",value:s.data?.activeBooks?.toString()??(s.isLoading?"…":"0")},{label:"Authors",value:s.data?.authorsCount?.toString()??(s.isLoading?"…":"0")}].map(r=>e.jsxs("div",{className:"rounded-2xl border border-gray-200 p-4 bg-gray-50",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:r.label}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.value})]},r.label))})]})})})}export{v as component};
