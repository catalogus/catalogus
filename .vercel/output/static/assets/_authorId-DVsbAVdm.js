import{A as p,u as g,j as e,s as m}from"./main-B5FlV0ud.js";import{H as b}from"./Header-DLdij8DV.js";import{M as x}from"./map-pin-DQhXgVI1.js";import{C as f}from"./calendar-lCNNRgkW.js";import{G as y,L as j,F as N,I as v,T as w,Y as k}from"./youtube-CxqPD9E6.js";import"./x-DfPbw0Sj.js";const _=(t,a)=>t||(a?m.storage.from("author-photos").getPublicUrl(a).data.publicUrl:null),U=t=>t.url?t.url:t.path?m.storage.from("author-photos").getPublicUrl(t.path).data.publicUrl:"",A=t=>{if(!t)return null;const a=new Date(t);return Number.isNaN(a.getTime())?null:a.toLocaleDateString("pt-PT",{day:"2-digit",month:"long",year:"numeric"})},L=t=>{if(!t)return null;const a=t.trim(),r=a.match(/<iframe[^>]+src=["']([^"']+)["']/i);if(r?.[1])return r[1];const l=a.match(/src=["']([^"']+)["']/i);return l?.[1]?l[1]:a.startsWith("<")?null:a},P=t=>{const a=L(t);if(!a)return null;const r=a.startsWith("//")?`https:${a}`:a;let l;try{l=new URL(r)}catch{return null}const n=l.hostname.replace(/^www\./,"");if(n==="youtu.be"){const i=l.pathname.slice(1);return i?`https://www.youtube.com/embed/${i}`:null}if(n.endsWith("youtube.com")||n.endsWith("youtube-nocookie.com")){const i=l.pathname.split("/").filter(Boolean),c=i[0]==="embed"||i[0]==="shorts"?i[1]:null,s=l.searchParams.get("v")||c;return s?`https://www.youtube.com/embed/${s}`:null}if(n==="player.vimeo.com"||n.endsWith("vimeo.com")){const i=l.pathname.split("/").filter(Boolean),c=i[i.length-1];return c?`https://player.vimeo.com/video/${c}`:null}return null},$=t=>{const a=t?.social_links??{};return[{key:"website",href:a.website,icon:y,label:"Website"},{key:"linkedin",href:a.linkedin,icon:j,label:"LinkedIn"},{key:"facebook",href:a.facebook,icon:N,label:"Facebook"},{key:"instagram",href:a.instagram,icon:v,label:"Instagram"},{key:"twitter",href:a.twitter,icon:w,label:"Twitter"},{key:"youtube",href:a.youtube,icon:k,label:"YouTube"}].filter(r=>r.href)};function W(){const{authorId:t}=p.useParams(),a=g({queryKey:["author",t],queryFn:async()=>{const s="id, wp_slug, name, author_type, bio, photo_url, photo_path, social_links, birth_date, residence_city, province, published_works, author_gallery, featured_video",{data:o,error:d}=await m.from("authors").select(s).eq("wp_slug",t).maybeSingle();if(d)throw d;if(o)return o;const{data:u,error:h}=await m.from("authors").select(s).eq("id",t).maybeSingle();if(h)throw h;return u??null},staleTime:6e4}),r=a.data??null,l=_(r?.photo_url,r?.photo_path),n=$(r),i=A(r?.birth_date),c=P(r?.featured_video);return e.jsxs("div",{className:"min-h-screen bg-white text-gray-900",children:[e.jsx(b,{}),a.isLoading&&e.jsx("div",{className:"container mx-auto px-4 py-24 lg:px-15",children:e.jsx("div",{className:"h-72 rounded-none border border-gray-200 bg-gray-100 animate-pulse"})}),a.isError&&e.jsx("div",{className:"container mx-auto px-4 py-24 lg:px-15",children:e.jsx("div",{className:"border border-gray-200 bg-white p-6 text-sm text-gray-600 rounded-none",children:"Falha ao carregar o autor. Tente novamente."})}),!a.isLoading&&!a.isError&&!r&&e.jsx("div",{className:"container mx-auto px-4 py-24 lg:px-15",children:e.jsx("div",{className:"border border-gray-200 bg-white p-6 text-sm text-gray-600 rounded-none",children:"Autor não encontrado."})}),!a.isLoading&&!a.isError&&r&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"relative overflow-hidden bg-[#1c1b1a] text-white",children:[l&&e.jsx("img",{src:l,alt:r.name,className:"absolute inset-0 h-full w-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/85 via-black/60 to-black/20"}),e.jsx("div",{className:"relative z-10",children:e.jsx("div",{className:"container mx-auto px-4 py-24 lg:px-15",children:e.jsxs("div",{className:"max-w-3xl space-y-5",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/70",children:"Autor em destaque"}),e.jsx("h1",{className:"text-4xl font-semibold leading-tight md:text-6xl",children:r.name}),r.author_type&&e.jsx("p",{className:"text-base uppercase tracking-[0.3em] text-white/70",children:r.author_type}),e.jsxs("div",{className:"text-xs uppercase tracking-[0.3em] text-white/60",children:[e.jsx("a",{href:"/",className:"hover:text-white",children:"Home"})," ","/"," ",e.jsx("a",{href:"/autores",className:"hover:text-white",children:"Autores"})," ","/ ",r.name]})]})})})]}),e.jsx("main",{className:"py-20",children:e.jsx("div",{className:"container mx-auto px-4 lg:px-15",children:e.jsxs("div",{className:"grid gap-12 lg:grid-cols-[320px_1fr]",children:[e.jsxs("aside",{className:"space-y-8",children:[e.jsxs("div",{className:"border border-gray-200 bg-white p-6 rounded-none",children:[e.jsx("div",{className:"aspect-[4/5] w-full overflow-hidden bg-[#f4f1ec]",children:l?e.jsx("img",{src:l,alt:r.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center text-5xl font-semibold text-gray-300",children:r.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"mt-6 space-y-3 text-sm text-gray-600",children:[r.residence_city&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:r.residence_city})]}),r.province&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:r.province})]}),i&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:i})]})]})]}),n.length>0&&e.jsxs("div",{className:"border border-gray-200 bg-white p-6 rounded-none",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Redes sociais"}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-3",children:n.map(s=>{const o=s.icon;return e.jsx("a",{href:s.href,target:"_blank",rel:"noreferrer",className:"flex h-10 w-10 items-center justify-center border border-gray-200 text-gray-700 transition hover:border-gray-900 hover:text-gray-900","aria-label":s.label,children:e.jsx(o,{className:"h-4 w-4"})},s.key)})})]})]}),e.jsxs("section",{className:"space-y-10",children:[r.bio&&e.jsxs("div",{className:"border border-gray-200 bg-white p-8 rounded-none",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Biografia"}),e.jsx("h2",{className:"mt-4 text-2xl font-semibold text-gray-900",children:"Conheça o autor"}),e.jsx("p",{className:"mt-4 text-base leading-relaxed text-gray-700",children:r.bio})]}),Array.isArray(r.published_works)&&r.published_works.length>0&&e.jsxs("div",{className:"border border-gray-200 bg-white p-8 rounded-none",children:[e.jsx("div",{className:"flex flex-col gap-2 md:flex-row md:items-end md:justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Obras publicadas"}),e.jsx("h2",{className:"mt-2 text-2xl font-semibold text-gray-900",children:"Bibliografia selecionada"})]})}),e.jsx("div",{className:"mt-8 grid gap-6 md:grid-cols-2",children:r.published_works.map((s,o)=>e.jsx("article",{className:"border border-gray-200 bg-[#fdfbf7] p-5 rounded-none",children:e.jsxs("div",{className:"flex gap-4",children:[s.cover_url?e.jsx("img",{src:s.cover_url,alt:s.title,className:"h-24 w-16 object-cover",loading:"lazy"}):e.jsx("div",{className:"h-24 w-16 bg-gray-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-gray-500",children:s.genre}),e.jsx("p",{className:"text-sm text-gray-600",children:s.synopsis}),s.link&&e.jsx("a",{href:s.link,target:"_blank",rel:"noreferrer",className:"text-xs uppercase tracking-[0.2em] text-gray-900 hover:underline",children:"Ver obra"})]})]})},`${s.title}-${o}`))})]}),Array.isArray(r.author_gallery)&&r.author_gallery.length>0&&e.jsxs("div",{className:"border border-gray-200 bg-white p-8 rounded-none",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Galeria do autor"}),e.jsx("h2",{className:"mt-2 text-2xl font-semibold text-gray-900",children:"Momentos e bastidores"}),e.jsx("div",{className:"mt-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:r.author_gallery.map((s,o)=>{const d=U(s);return d?e.jsxs("figure",{className:"group overflow-hidden bg-[#f4efe9]",children:[e.jsx("img",{src:d,alt:s.caption||r.name,className:"h-48 w-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),s.caption&&e.jsx("figcaption",{className:"px-3 py-2 text-xs text-gray-600",children:s.caption})]},`${d}-${o}`):null})})]}),r.featured_video&&e.jsxs("div",{className:"border border-gray-200 bg-white p-8 rounded-none",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Video em destaque"}),e.jsx("h2",{className:"mt-2 text-2xl font-semibold text-gray-900",children:"Conversa com o autor"}),e.jsx("div",{className:"mt-6",children:c?e.jsx("div",{className:"relative aspect-video w-full overflow-hidden bg-black",children:e.jsx("iframe",{src:c,title:`Video de ${r.name}`,className:"absolute inset-0 h-full w-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):e.jsx("a",{href:r.featured_video,target:"_blank",rel:"noreferrer",className:"text-sm font-semibold text-gray-900 hover:underline",children:"Assistir video"})})]})]})]})})})]})]})}export{W as component};
